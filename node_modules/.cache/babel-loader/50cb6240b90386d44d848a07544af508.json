{"ast":null,"code":"import Stomp from 'webstomp-client';\nimport SockJS from 'sockjs-client';\nimport bottomNav from '@/components/bottomNav.vue'; // import { ref } from 'vue';\n\nexport default {\n  name: 'App',\n  components: {\n    bottomNav\n  },\n  data: () => ({\n    model: 0,\n    colors: ['primary', 'secondary', 'yellow darken-2', 'red', 'orange'],\n    auction: null,\n    bid_price: null\n  }),\n\n  created() {\n    this.connect();\n    console.log(this.$route.params.auction);\n    this.auction = JSON.parse(this.$route.params.auction); // for문 방식\n    // console.log(\"this.$route.params.id\");\n    // console.log(this.$route.params.id);\n    // for (let i = 0; i < this.$store.state.auctionList.length; i++) {\n    //     console.log(this.$store.state.auctionList[i].auction_Id); \n    //     if(this.$route.params.id == this.$store.state.auctionList[i].auction_Id){\n    //         this.auction = this.$store.state.auctionList[i]\n    //         break;\n    //     }\n    // }\n\n    console.log(this.auction);\n  },\n\n  methods: {\n    bid() {\n      console.log(\"auction.auction_Id:\" + this.auction.auction_Id);\n      console.log(\"bid_price:\" + this.bid_price);\n      console.log(\"auction.bid_price: \" + this.auction.bid_price);\n      console.log(this.stompClient);\n      console.log(this.stompClient.connected);\n\n      if (this.bid_price > this.auction.bid_price && this.stompClient && this.stompClient.connected) {\n        this.stompClient.send(\"/receive_bidding\", JSON.stringify({\n          auction_id: this.auction.auction_Id,\n          bid_price: this.bid_price\n        }), {});\n      } else {\n        alert(\"현재 경매가격보다 낮습니다!!\");\n      }\n    },\n\n    connect() {\n      const serverURL = \"http://localhost:8080/socket\";\n      let socket = new SockJS(serverURL);\n      this.stompClient = Stomp.over(socket);\n      console.log(`소켓 연결을 시도합니다. 서버 주소: ${serverURL}`);\n      console.log(this.$store.state.config.headers);\n      let headers = {\n        TOKEN: this.$store.state.config.headers.TOKEN\n      };\n      console.log(headers);\n      this.stompClient.connect(headers, frame => {\n        this.connected = true;\n        console.log('소켓 연결 성공', frame);\n        this.stompClient.subscribe(\"/send_bidding\", res => {\n          const response_bidding = JSON.parse(res.body);\n          console.log(response_bidding);\n\n          if (response_bidding.auction_id != undefined) {\n            this.$store.commit('UPDATE_BID_PRICE', response_bidding);\n            this.auction.bid_price = this.bid_price;\n          }\n        });\n      }, error => {\n        // 소켓 연결 실패\n        console.log('소켓 연결 실패', error);\n        this.connected = false;\n      });\n    }\n\n  }\n};","map":{"version":3,"mappings":"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","names":["Stomp","SockJS","bottomNav","name","components","data","model","colors","auction","bid_price","created","connect","console","log","$route","params","JSON","parse","methods","bid","auction_Id","stompClient","connected","send","stringify","auction_id","alert","serverURL","socket","over","$store","state","config","headers","TOKEN","frame","subscribe","res","response_bidding","body","undefined","commit","error"],"sourceRoot":"","sources":["/home/realvue/src/views/auction/auction_detail.vue"],"sourcesContent":["<template>\r\n<div>\r\n    <div class=\"main_nav_t_div\">\r\n        <nav class=\"main_t_nav\">\r\n            <ul class=\"main_t_nav_list\">\r\n                <li class=\"nav__btn\">\r\n                    <a class=\"nav__link\" href=\"alert\"><i class=\"fas fa-bell fa-2x\" aria-hidden=\"true\"></i>\r\n                    </a>\r\n                </li>\r\n\r\n                <li class=\"nav__btn\">\r\n                    <a class=\"nav__link\" href=\"main\"><i class=\"fas fa-running fa-2x\" aria-hidden=\"true\" image\r\n                            src=\"../image/123.jpg\"></i>\r\n                    </a>\r\n                </li>\r\n\r\n                <li class=\"nav__btn\">\r\n                    <div class=\"nav__notification-dot\"></div>\r\n                    <a class=\"nav__link\" href=\"auction\"><i class=\"fas fa-plus fa-2x\" aria-hidden=\"true\"></i>\r\n                    </a>\r\n                </li>\r\n            </ul>\r\n        </nav>\r\n    </div>\r\n\r\n    <v-carousel v-model=\"model\">\r\n            <v-carousel-item v-for=\"(color, i) in colors\" :key=\"color\">\r\n                <v-sheet :color=\"color\" height=\"100%\" tile>\r\n                    <v-row class=\"fill-height\" align=\"center\" justify=\"center\">\r\n                        <div class=\"text-h2\">\r\n                            Slide {{ i + 1 }}\r\n                        </div>\r\n                    </v-row>\r\n                </v-sheet>\r\n            </v-carousel-item>\r\n        </v-carousel>\r\n\r\n    <fieldset>\r\n        <h2 class=\"profileh2\">인기 검색어</h2>\r\n\r\n        <div class=\"aside_area aside_popular\">\r\n            <h3 class=\"h_popular\"></h3>\r\n            <table class=\"tbl_home\">\r\n                <tbody>\r\n                    <tr class=\"\">\r\n                        <th>{{auction.productDTO.product}}</th>\r\n                        <td>{{auction.productDTO.product_kg}}kg</td>\r\n                    </tr>\r\n\r\n                    <tr class=\"\">\r\n                        <th>시작 가격</th>\r\n                        <td>{{auction.a_starting_price}}원</td>\r\n                    </tr>\r\n\r\n                    <tr class=\"\">\r\n                        <th>현재 가격</th>\r\n                        <td>{{auction.bid_price}}원</td>\r\n                    </tr>\r\n\r\n                    <tr class=\"\">\r\n                        <th>낙과 일자</th>\r\n                        <td>{{auction.productDTO.p_drop_date}}</td>\r\n                    </tr>\r\n\r\n                    <tr class=\"\">\r\n                        <th>사이즈</th>\r\n                        <td>{{auction.productDTO.size}} </td>\r\n                    </tr>\r\n\r\n                    <tr class=\"\">\r\n                        <th>상태</th>\r\n                        <td>{{auction.productDTO.p_status}}</td>\r\n                    </tr>\r\n                </tbody>\r\n            </table>\r\n        </div>\r\n        <div>\r\n            <input type=\"number\" id=bid_price v-model=\"bid_price\">\r\n            <button @click=\"bid()\">입찰하기</button>\r\n        </div>\r\n    </fieldset>\r\n\r\n    <h3 class=\"h3_middle\">{{auction.productDTO.p_explanation}}</h3>\r\n    <h2 class=\"profileh2\">생산자 정보</h2>\r\n\r\n        <div class=\"goods_group\">\r\n            <ul class=\"goods_group_list\">\r\n                <li id=\"_rowLi20220213173042CHK2022021381488661\" class=\"goods_pay_item \">\r\n                    <div class=\"goods_item\">\r\n                        <a href=\"/orderStatus/2022021339733581\" class=\"goods_thumb\">\r\n                            <img :src='`http://localhost:8080/product_images/${auction.productDTO.product_img_name}.png`'\r\n                                        alt=\"\" width=\"90\" height=\"90\" /></a>\r\n                            <!-- <img src=\"https://suhofarm.com/_upload/mall/20220112173148_86227.jpg\" alt=\"\" width=\"90\" height=\"90\"> -->\r\n                        <div class=\"goods_info\">\r\n\r\n                            <p class=\"guide2\">\r\n                                농가명 : {{auction.f_farm_name}}\r\n                            </p>\r\n                            <p class=\"guide2\">\r\n                                대표자 : {{auction.f_name}}\r\n                            </p>\r\n                            <p class=\"guide2\">\r\n                                사업자 등록번호 : {{auction.f_num}}\r\n                            </p>\r\n                            <p class=\"guide2\">\r\n                                농가 주소 : {{auction.f_location}}\r\n                            </p>\r\n                            <p class=\"guide2\">\r\n                                연락처 : {{auction.f_phonenum}}\r\n                            </p>\r\n                        </div>\r\n                    </div>\r\n                    <div class=\"seller_item\">\r\n                        <div class=\"inner\">\r\n\r\n                            <span class=\"seller\">{{auction.f_farm_name}}</span>\r\n                            <span class=\"tel\">{{auction.f_phonenum}}</span>\r\n                            <a href=\"#\"\r\n                                class=\"state_button qna _click(nmp.front.order.timeline.home.list.shoppingInquiry(/merchant/shoppingInquiry/2022021381488661)) _stopDefault\">문의하기</a>\r\n                        </div>\r\n                    </div>\r\n                </li>                \r\n            </ul>\r\n        </div>\r\n    <form action=\"farm_intro\" class=\"login-form\">\r\n        <input class=\"login-form__btn\" type=\"submit\" value=\"농가 상세 소개\">\r\n    </form>\r\n    <bottom-nav></bottom-nav>\r\n</div>\r\n</template>\r\n\r\n\r\n\r\n<script>\r\nimport Stomp from 'webstomp-client'\r\nimport SockJS from 'sockjs-client'\r\nimport bottomNav from '@/components/bottomNav.vue';\r\n// import { ref } from 'vue';\r\n\r\nexport default {\r\n    name: 'App',\r\n    components: { bottomNav },\r\n\r\n    data: () => ({\r\n        model: 0,\r\n        colors: [\r\n            'primary',\r\n            'secondary',\r\n            'yellow darken-2',\r\n            'red',\r\n            'orange',\r\n        ],\r\n        auction: null,\r\n        bid_price: null,\r\n    }),\r\n    created() {\r\n        this.connect()\r\n        \r\n        console.log(this.$route.params.auction);\r\n        this.auction = JSON.parse(this.$route.params.auction)\r\n\r\n        // for문 방식\r\n        // console.log(\"this.$route.params.id\");\r\n        // console.log(this.$route.params.id);\r\n        // for (let i = 0; i < this.$store.state.auctionList.length; i++) {\r\n        //     console.log(this.$store.state.auctionList[i].auction_Id); \r\n        //     if(this.$route.params.id == this.$store.state.auctionList[i].auction_Id){\r\n        //         this.auction = this.$store.state.auctionList[i]\r\n        //         break;\r\n        //     }\r\n        // }\r\n        console.log(this.auction);\r\n    },\r\n    methods: {\r\n        bid(){\r\n            console.log(\"auction.auction_Id:\" + this.auction.auction_Id);\r\n            console.log(\"bid_price:\" + this.bid_price);\r\n            console.log(\"auction.bid_price: \" + this.auction.bid_price);\r\n            console.log(this.stompClient);\r\n            console.log(this.stompClient.connected);\r\n\r\n            if (this.bid_price > this.auction.bid_price && this.stompClient && this.stompClient.connected){\r\n                this.stompClient.send(\"/receive_bidding\", JSON.stringify({auction_id: this.auction.auction_Id, bid_price: this.bid_price}), {});\r\n            } else {\r\n                alert(\"현재 경매가격보다 낮습니다!!\")\r\n            }\r\n        },\r\n        connect() {\r\n            const serverURL = \"http://localhost:8080/socket\"\r\n            let socket = new SockJS(serverURL);\r\n            this.stompClient = Stomp.over(socket);\r\n            console.log(`소켓 연결을 시도합니다. 서버 주소: ${serverURL}`)\r\n\r\n            console.log(this.$store.state.config.headers);\r\n            let headers = { TOKEN: this.$store.state.config.headers.TOKEN };\r\n            console.log(headers);\r\n            this.stompClient.connect(\r\n            headers,\r\n            frame => {\r\n                this.connected = true;\r\n                console.log('소켓 연결 성공', frame);\r\n\r\n                this.stompClient.subscribe(\"/send_bidding\",  res => {\r\n\r\n                    const response_bidding = JSON.parse(res.body);\r\n                    console.log(response_bidding);\r\n                    if (response_bidding.auction_id != undefined) {\r\n                        this.$store.commit('UPDATE_BID_PRICE', response_bidding);\r\n                        \r\n                        this.auction.bid_price = this.bid_price\r\n                    }\r\n                });\r\n            },\r\n            error => {\r\n                // 소켓 연결 실패\r\n                console.log('소켓 연결 실패', error);\r\n                this.connected = false;\r\n            }\r\n            );        \r\n        }\r\n    },  \r\n    \r\n    \r\n}\r\n\r\n</script>\r\n\r\n\r\n<style>\r\n\r\n</style>"]},"metadata":{},"sourceType":"module"}