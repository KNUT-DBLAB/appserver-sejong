{"ast":null,"code":"// import axios from \"axios\"\nimport Stomp from 'webstomp-client';\nimport SockJS from 'sockjs-client';\nimport bottomNav from '@/components/bottomNav.vue'; // import { ref } from 'vue';\n\nexport default {\n  components: {\n    bottomNav\n  },\n\n  data() {\n    return {\n      limit: 0,\n      auctionList: [],\n      // 배열에 저장 v-for=\"product in productList\" -> v-for 문 사용해서 표시\n      model: 0,\n      colors: ['primary', 'secondary', 'yellow darken-2', 'red', 'orange']\n    };\n  },\n\n  //데이터베이스 에서 배열로 가져와서\n  created() {\n    // vue 생성 시 소켓 연결\n    this.connect();\n  },\n\n  methods: {\n    moreProduct() {\n      this.send();\n    },\n\n    bid(bidding) {\n      this.send_bidding(bidding);\n    },\n\n    send() {\n      console.log(\"limit:\" + this.limit);\n      console.log(this.stompClient);\n      console.log(this.stompClient.connected);\n\n      if (this.stompClient && this.stompClient.connected) {\n        console.log(this.limit);\n        console.log(this.$store.state.config.headers.TOKEN);\n        this.stompClient.send(\"/receive_limit/\" + this.$store.state.config.headers.TOKEN, this.limit, {});\n        this.limit += 2;\n        console.log(this.auctionList);\n      }\n    },\n\n    send_bidding(bidding) {\n      console.log(\"bid_price:\" + bidding.bid_price);\n      console.log(this.stompClient);\n      console.log(this.stompClient.connected);\n\n      if (this.stompClient && this.stompClient.connected) {\n        console.log(\"auction_id: \" + bidding.auction_id);\n        console.log(\"bid_price:\" + bidding.bid_price);\n        this.stompClient.send(\"/receive_bidding\", JSON.stringify(bidding), {});\n        console.log(this.auctionList);\n      }\n    },\n\n    connect() {\n      const serverURL = \"http://localhost:8080/socket\";\n      let socket = new SockJS(serverURL);\n      this.stompClient = Stomp.over(socket);\n      console.log(`소켓 연결을 시도합니다. 서버 주소: ${serverURL}`);\n      this.stompClient.connect({}, frame => {\n        this.connected = true;\n        console.log('소켓 연결 성공', frame);\n        this.stompClient.subscribe(\"/send_auction_data/\" + this.$store.state.config.headers.TOKEN, res => {\n          const response_data = JSON.parse(res.body);\n          console.log(response_data[0]);\n          console.log(response_data.length);\n\n          for (let i = 0; i < response_data.length; i++) {\n            this.auctionList.push(response_data[i]);\n          }\n\n          console.log(\"this.auctionList\");\n          console.log(this.auctionList[0]);\n        });\n        this.stompClient.subscribe(\"/send_bidding\", res => {\n          const response_data = JSON.parse(res.body);\n          console.log(response_data);\n        });\n      }, error => {\n        // 소켓 연결 실패\n        console.log('소켓 연결 실패', error);\n        this.connected = false;\n      });\n    }\n\n  }\n};","map":{"version":3,"mappings":"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","names":["Stomp","SockJS","bottomNav","components","data","limit","auctionList","model","colors","created","connect","methods","moreProduct","send","bid","bidding","send_bidding","console","log","stompClient","connected","$store","state","config","headers","TOKEN","bid_price","auction_id","JSON","stringify","serverURL","socket","over","frame","subscribe","res","response_data","parse","body","length","i","push","error"],"sourceRoot":"","sources":["/home/realvue/src/views/main/auction.vue"],"sourcesContent":["<template>\n<div>\n  <div class=\"main_nav_t_div\">\n    <nav class=\"main_t_nav\">\n        <ul class=\"main_t_nav_list\">\n            <li class=\"nav__btn\">\n                <div class=\"nav__notification-dot\"></div>\n                <a class=\"nav__link\"><i class=\"fas fa-bars fa-2x\" aria-hidden=\"true\"></i>\n                </a>\n            </li>\n\n            \n            <li class=\"main_m_li_list\">\n                <a class=\"nav_m_link\" href=\"workout.html\">\n                    <h4 class=\"user-component__title\">경매 알림</h4><i class=\" fa-2x\" aria-hidden=\"true\" image\n                        src=\"../image/123.jpg\"></i>\n                </a>\n            </li>\n\n            <li class=\"nav__btn\">\n                <a class=\"nav__link\" onclick=\"goBack()\"><i class=\"fas fa-chevron-left fa-2x\"\n                        aria-hidden=\"true\"></i>\n                </a>\n            </li>\n          </ul>\n      </nav>\n  </div>\n  \n    <v-carousel v-model=\"model\">\n      <v-carousel-item v-for=\"(color, i) in colors\" :key=\"color\">\n          <v-sheet :color=\"color\" height=\"100%\" tile>\n              <v-row class=\"fill-height\" align=\"center\" justify=\"center\">\n                  <div class=\"text-h2\">\n                      Slide {{ i + 1 }}\n                  </div>\n              </v-row>\n          </v-sheet>\n      </v-carousel-item>\n    </v-carousel>\n\n    <fieldset>\n        <div class=\"white_div\">\n            <div class=\"goods_pay_section \">\n                <div class=\"goods_group\">\n                    <ul class=\"goods_group_list\">\n                        <li v-for=\"auction in auctionList\" :key=\"auction.auction_Id\"\n                            id=\"_rowLi20220203162708CHK2022020394386781\"\n                            class=\"goods_pay_item _interlockNo20220211200904406814\">\n                            <div class=\"goods_item\">\n                              <!-- a 태그 -> router 태그 -->\n                                <a href=\"/orderStatus/2022020310590721\" class=\"goods_thumb\">\n                                    <img :src='`http://localhost:8080/product_images/${auction.productDTO.product_img_name}.png`'\n                                        alt=\"\" width=\"90\" height=\"90\" /></a>\n                                <div class=\"goods_info\">\n                                    <a href=\"/orderStatus/2022020310590721\" class=\"goods\">\n                                        <p class=\"name\">\n                                            {{auction.productDTO.product}}\n                                        </p>\n                                        <ul class=\"info\">\n                                            <li><span class=\"blind\">상품금액</span>{{auction.a_max_price}}원</li>\n                                            <li class=\"date\"><span class=\"blind\">등록일</span> {{auction.productDTO.p_reg_date}}\n                                            </li>\n                                        </ul>\n                                    </a>\n                                    <a href=\"#\"\n                                        class=\"state _statusName value_color_green _click(nmp.front.order.timeline.home.list.openDeliveryPopup(/o/orderStatus/deliveryTracking/2022020394386781/ORDER_DELIVERY/api)) _stopDefault\">{{auction.bid_status}}\n                                        ({{auction.deadline_date}} 경매 종료)</a>\n                                    <p class=\"guide\">\n                                        {{auction.productDTO.p_explanation}}\n                                    </p>\n                                </div>\n                            </div>\n                            <div class=\"seller_item\">\n                                <div class=\"inner\">\n\n                                    <span class=\"seller\">{{auction.f_farm_name}}</span>\n                                    <span class=\"tel\">{{auction.f_phonenum}}</span>\n                                    <a href=\"#\"\n                                        class=\"state_button qna _click(nmp.front.order.timeline.home.list.shoppingInquiry(/merchant/shoppingInquiry/2022020394386781)) _stopDefault\">문의하기</a>\n                                </div>\n                            </div>\n                            <div>\n                                <form @submit.prevent=\"auction.bid_price\">\n                              <input type=\"number\" id=auction.bid_price value=\"auction.bid_price\">\n                              <button @click=\"bid({auction_id: auction.auction_Id, bid_price})\">입찰</button>\n                                </form>\n                            </div>\n                        </li>\n                    </ul>\n                </div>\n            </div>\n        </div>\n    </fieldset>\n    <div>\n      <button @click=\"moreProduct()\">웹소켓</button>\n    </div>\n\n    <bottom-nav></bottom-nav>\n</div>\n</template>\n\n<script>\n// import axios from \"axios\"\nimport Stomp from 'webstomp-client'\nimport SockJS from 'sockjs-client'\nimport bottomNav from '@/components/bottomNav.vue';\n// import { ref } from 'vue';\n\n\nexport default{\n\n  components: { bottomNav },\n  data() {\n      return {            \n          limit: 0,\n          auctionList: [], // 배열에 저장 v-for=\"product in productList\" -> v-for 문 사용해서 표시\n          model: 0,\n          colors: [\n              'primary',\n              'secondary',\n              'yellow darken-2',\n              'red',\n              'orange',\n          ],\n      }\n  },\n  \n  //데이터베이스 에서 배열로 가져와서\n  created() {\n    // vue 생성 시 소켓 연결\n    this.connect()\n  },\n\n  methods: {\n    moreProduct () {\n      this.send()\n    },\n    bid(bidding){\n      this.send_bidding(bidding)\n    },    \n    send() {\n      console.log(\"limit:\" + this.limit);\n      console.log(this.stompClient);\n      console.log(this.stompClient.connected);\n      if (this.stompClient && this.stompClient.connected) {\n        console.log(this.limit);\n        console.log(this.$store.state.config.headers.TOKEN);\n        this.stompClient.send(\"/receive_limit/\"+this.$store.state.config.headers.TOKEN, this.limit, {});\n        this.limit += 2;\n        console.log(this.auctionList);\n      }\n    },\n    send_bidding(bidding){\n      console.log(\"bid_price:\" + bidding.bid_price);\n      console.log(this.stompClient);\n      console.log(this.stompClient.connected);\n      if (this.stompClient && this.stompClient.connected) {\n        console.log(\"auction_id: \" + bidding.auction_id);\n        console.log(\"bid_price:\" + bidding.bid_price);\n        this.stompClient.send(\"/receive_bidding\", JSON.stringify(bidding), {});\n        console.log(this.auctionList);\n      }\n    },\n    connect() {\n      const serverURL = \"http://localhost:8080/socket\"\n      let socket = new SockJS(serverURL);\n      this.stompClient = Stomp.over(socket);\n      console.log(`소켓 연결을 시도합니다. 서버 주소: ${serverURL}`)\n      this.stompClient.connect(\n        {},\n        frame => {\n          this.connected = true;\n          console.log('소켓 연결 성공', frame);\n\n          this.stompClient.subscribe(\"/send_auction_data/\"+this.$store.state.config.headers.TOKEN,  res => {\n\n            const response_data = JSON.parse(res.body);\n            console.log(response_data[0]);\n            console.log(response_data.length);\n            for (let i = 0; i < response_data.length; i++) {\n              this.auctionList.push(response_data[i])\n            }\n            console.log(\"this.auctionList\");\n            console.log(this.auctionList[0]);\n          });\n          this.stompClient.subscribe(\"/send_bidding\",  res => {\n\n            const response_data = JSON.parse(res.body);\n            console.log(response_data);\n          });\n        },\n        error => {\n          // 소켓 연결 실패\n          console.log('소켓 연결 실패', error);\n          this.connected = false;\n        }\n      );        \n    }\n  }\n}\n</script>\n\n<style>\n</style>\n\n"]},"metadata":{},"sourceType":"module"}